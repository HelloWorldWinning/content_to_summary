Timestamp: 2025-11-10T05:12:26.450287
Title: 白话讲Mamba模型 BV1d31NBJEVJ
URL: https://b23.tv/GBQPpiS
Status: success
Duration: 14:27

Description:
好的，这是根据您提供的文本内容提炼和总结的核心思想。

### **内容概要与核心思想**

#### **一、 基础理论：状态空间模型 (SSM)**
*   **核心定义**：SSM (State Space Model) 是一个描述系统动态变化的数学框架，它通过“状态向量”来表示系统在任意时刻的状态。
*   **数学表达**：主要由两个方程定义，一个描述隐藏状态的变化率（状态方程 `h'(t) = Ah(t) + Bx(t)`），另一个描述如何根据隐藏状态生成输出（输出方程 `y(t) = Ch(t) + Dx(t)`）。
*   **与RNN的关系**：RNN可以被看作是SSM的一种**离散化**的、非线性的特殊形式，因此SSM是更底层的概念。
*   **核心局限**：原生的SSM处理的是**连续时间**的序列数据，而深度学习中常见的文本等数据是离散的。

#### **二、 首次进化：结构化状态空间模型 (S4)**
*   **核心改进：离散化**：为了处理离散数据（如文本），S4模型通过特定的采样方法（零阶保持）将连续的SSM参数（A, B矩阵）转换为离散形式（Ā, B̄矩阵）。
*   **双模式运作**：
    1.  **循环模式 (RNN Mode)**：形式与RNN类似，计算是串行的。**优点是推理速度快**，但**缺点是训练速度慢**，无法并行。
    2.  **卷积模式 (Convolutional Mode)**：通过数学变换，可以将整个序列的计算表示为一个大型的一维卷积操作。**优点是训练速度快**（可并行），但**缺点是推理效率低**。
*   **S4的策略**：利用**卷积模式进行并行训练**，然后切换到**循环模式进行高效推理**，兼具两种模式的优点。同时，使用HiPPO技术对A矩阵进行特殊初始化，以增强长距离依赖的捕捉能力。
*   **核心局限**：S4模型的参数（Ā, B̄, C）在训练完成后是**静态的、不随输入变化**的。这导致模型无法根据当前输入内容，有选择性地关注或遗忘历史信息。

#### **三、 关键突破：Mamba模型**
Mamba旨在解决S4模型静态、无选择性的核心缺陷。
*   **创新点1：选择性机制 (Selection Mechanism)**
    *   **实现方式**：将原本固定的A, B, C等核心参数变为**输入数据的函数**。通过引入类似门控的机制，让模型可以根据当前的输入`x(t)`动态地调整其内部状态转换的行为。
    *   **效果**：使模型具备了**选择性处理信息**的能力，可以动态地决定哪些历史信息需要保留，哪些需要遗忘，从而更智能地处理序列。
*   **创新点2：并行扫描算法 (Parallel Scan)**
    *   **背景**：由于引入了选择性（输入依赖），S4的卷积模式失效了，无法直接用于并行训练。
    *   **解决方案**：Mamba采用了一种硬件友好的并行扫描算法。该算法通过“前向传播”和“回溯计算”两个阶段，可以在保持模型动态性的同时，实现高效的**并行化训练**。
*   **创新点3：简化的架构**：相较于Transformer，Mamba的整体模型架构更简洁。

---

### **核心结论 (Core Point)**

Mamba通过引入输入依赖的“选择性机制”和高效的“并行扫描算法”，成功解决了传统状态空间模型（S4）无法动态处理序列信息的关键问题，使其成为一个兼具RNN推理效率和Transformer级别性能的强大序列模型。

### **内容 overarching 框架 (Overarching Framework)**

本内容遵循一条清晰的**技术演进路线**进行讲解：首先介绍作为理论基石的**状态空间模型（SSM）**，然后阐述其为适应深度学习而进化出的**S4模型**，并深入分析S4模型的“并行训练”优势与“静态无选择性”的局限，最终引出主角**Mamba模型**，详细说明其是如何通过“选择性机制”和“并行扫描算法”两大创新，完美解决了S4的痛点，从而构建出一个更先进、更高效的序列处理新范式。

### **概念关系图 (Mermaid Conceptual Map)**

<Mermaid_Diagram>
graph TD
    subgraph "理论基础 (Foundation)"
        SSM["状态空间模型 (SSM)"];
        SSM_Def["核心: 描述连续动态系统"];
        SSM_Eq["h'(t) = Ah(t) + Bx(t)"];
        SSM_Limit["局限: 无法处理离散数据"];
        SSM --> SSM_Def;
        SSM --> SSM_Eq;
        SSM --> SSM_Limit;
    end

    subgraph "首次进化 (Evolution 1)"
        S4["S4模型"];
        Discretization["离散化 (Discretization)"];
        RNN_Mode["循环模式 (RNN Mode)"];
        Conv_Mode["卷积模式 (Convolutional Mode)"];
        S4_Strategy["训练(卷积) + 推理(循环)"];
        S4_Limit["缺陷: 静态参数, 无选择性"];

        Discretization --> S4;
        S4 --> RNN_Mode;
        S4 --> Conv_Mode;
        RNN_Mode -- "快速推理" --> S4_Strategy;
        Conv_Mode -- "并行训练" --> S4_Strategy;
        S4_Strategy --> S4_Limit;
    end

    subgraph "关键突破 (Breakthrough)"
        Mamba["Mamba模型"];
        Selection["创新1: 选择性机制 (Selection)"];
        Input_Dependent["A(x), B(x), C(x) <br> (参数依赖于输入)"];
        Parallel_Scan["创新2: 并行扫描算法"];
        Dynamic_Processing["优势: 动态处理信息"];

        Selection --> Input_Dependent;
        Mamba -- "核心思想" --> Selection;
        Input_Dependent -- "导致卷积失效, 故需要" --> Parallel_Scan;
        Mamba -- "实现并行训练" --> Parallel_Scan;
        Mamba --> Dynamic_Processing;
    end
    
    SSM_Limit -- "解决方案" --> Discretization;
    S4_Limit -- "解决方案" --> Mamba;

    style SSM fill:#AED6F1,stroke:#333,stroke-width:2px;
    style S4 fill:#A9DFBF,stroke:#333,stroke-width:2px;
    style Mamba fill:#FAD7A0,stroke:#333,stroke-width:2px;

    style SSM_Limit fill:#F5B7B1,stroke:#C0392B,stroke-width:1.5px;
    style S4_Limit fill:#F5B7B1,stroke:#C0392B,stroke-width:1.5px;
    
    style Selection fill:#D2B4DE,stroke:#333,stroke-width:1.5px;
    style Parallel_Scan fill:#D2B4DE,stroke:#333,stroke-width:1.5px;
    style Dynamic_Processing fill:#ABEBC6,stroke:#1E8449,stroke-width:1.5px;
</Mermaid_Diagram>

Content:
哈啰大家好,好有不见最近一直在更新大模型的课程然后视频这方面就没怎么更新曾次群里面的小伙伴就一直催我希望出一个模型经验的系列视频OK,那么它来了今天我们第一个角的模型就是漫画漫画可以说是几传的former之后一个有希望包括争议页比较大的一个模型主要是在于它想要取代传的former但是实现证明它只有在模型格领域上性能比传的former强包括你现在现在传的former的一个生态还是非常大的对吧漫画想起来传的former就不会就是不可能所以就让它处在一个不上不下的一个尴尬位置但是漫画的它的一个思想模型可能它是值得我们学习的然后废话不多说我们来看一下漫画简单来说它是基于结构化装点空间模型的一种深度学习模型所以在学习漫画之前我们先来了解一下什么是装点空间模型那就是SSSM我们先来看一下什么是装点空间装点空间是一种描述系统动态变化的是原框架这句话理解起来可能比较出现我们来看一个具体的例子就比如说这个迷宫它其实就可以看作是一个系统然后这个系统有许多的元素组成的部份就比如说我们人当前的一个位置我们可以把它看作是一个状态然后我们未来某个位置也可以看作是一个状态就比如说我们未来要到达紫色这个电的这个位置对吧然后紫色电那我们就可以把它看作一个未来状态然后以及包括我们未来想要做的一个动作就比如说往左走往上走这也可以看作是一个状态然后这些状态呢我们可以使用相量来表示所以他们也叫做一个状态相量简单的来说状态空间就是由这些状态相量组成然后SSSM就是根据某些输入预测其下一个状态是什么的一个模型简单来说我们以值得状态相量然后去预测一个位置的一个状态相量SSSM一般包括以下这几部分首先是一个ST就是我们的一个输入训练ST呢就是我们潜在状态的一个表示训练然后外体就是我们想要知道的一个输出的一个训练然后我们现在要做的就是把这个XT和ST拿出入到这个SSM到中然后去输出这个外体可能大家也注意到就是我不管说这个STST还是这个外体都带著一个训练对吧因为我们这个状态空间模型的它只能就是接受一些训练数据就不能接受那种疑散的这里大家就是注意一下SSSM的数据表达是呢主要是由这两方程来确定我们来看一下这个IT呢它就代表我们的一个潜在隐藏状态对吧然后这里多说一句就这个IT它是代表某一个给定时刻的一个潜在隐藏状态换成我们比较熟悉的一个形式这里应该是一个T简易就代表是上一个时刻对吧A呢就是代表一个状态方程它里面的信息其实就是之前所有时刻的一个信息浓缩然后这个ST就一个输入数据对吧然后B呢就一个数据证这个HPRT呢其实是这个HT的一个一阶微分倒数说白了其实就是这个HT的一个变化率对吧然后在SSSM到中呢它是代表这个HT的一个系统行为然后这个HT到这里呢它就代表是刀前的一个隐藏状态这个C是一个输出据证然后这个地脑是一个硬设据证通常这部分我们可以省略然后这个WAT就是我们的一个输出这个方程是不是有一点像这个RN的一个隐藏状态的一个方程结果就是把这个A据证换成了一个权重然后B据证换成了U然后前面加一个碳纯弹HT对吧所以说RN其实它是一个间接的一个SSSM方程我们来看一下就是如何把这两个方程给它统一首先我们需要一个输入对吧然后这个输入呢去成一个B据证弹上一个新的相量然后这个新的相量呢它需要是上一个时刻的一个隐藏状态然后去成一个A据证然后进行一个相加然后得出一个刀前时刻的一个HT的一个EGW分导处然后这里呢我们需要解下部分方程这是大学的支持大家忘了的话可以不去复习一下然后我解出来一个刀前状态的一个AGT就是这部分我们把它给旋转一下就代表是一个新的一个HT然后这个新的HT呢就需要和C据证进行一个据证称法然后产生一个相量这个相量呢可以加上这个DXT或者说不加然后直接变成一个输出是我们的一个外体对吧这个SSSM呢就有一点要注意就是它只能接收序列数据也就是我们说的连续时间表示的一个数据接下来我们来看一下如何把SSSM放到我们深入学习道中其实也就是SSS4不行刚刚我们也说过SSSM它只能处理训列数据不能处理离散数据对吧而我们在深入学习道中经常会碰到你想温本这种离散数据的一个任务那么我们要做的就是需要把SSSM给它离散化这里呢我们用到零接保持技术零接保持技术呢本来是把离散数据给它的连续化我们来看一下怎么做的离散数据其实简单来说就是有一个一个点来给它构成的对吧就比如说这里我们去到4个时刻其实就4个点然后零接保持技术它怎么做呢当我接收到一个值的时候那我就更新这个值在我没有接收到一个新值的时候那我就一直保持这个值就比如说我们在T10个接收到一个值对吧但是T1之后或说T1之后T2之前我们没有得到一个新的一个值那我就一直保持这个值直到T2时刻我接收到一个新的值那我就更新这个值然后我们再继续保持这个值然后T3也是一样的然后T4也是一样的这样的话我们就会得到一个连续的一个数据对吧然后10刻与10刻之间的一个10个键格呢我们把它叫做一个部长它是可以学习的也就是说针对不同的数据我可以学习到一个最优的一个部长我们再来想想其实一个连续数据呢它是不是也是有无数个离散数据来给它构成的如果我们想要把一个连续的数据给它离散化只需要就是使用部长对它心里一个彩药对吧其实就是这个样子这样我们是不是就把这个连续的数据给它离散化了然后我们把这个思想能其实也可以放在S、S、S、M上其实就是对A举证和B举证即行一个彩药然后它就会变成一个离散的A举证和B举证就是A、B和B然后我们再带到一个原始的S、S、M上我们这里来看一下就本来这里应该是一个HK对吧但是我们这里变成了一个HK检1就是具体就代表上一个时刻因为之前它是一个训练就可以代表任何给定的一个时刻这里是一个变化然后这里虽然没变但是它的一个表示的意义也变了这里HK就代表是当前的一个时刻组成一个离散化的一个S、S、M成功接下来我们就说要来处理一个数据了我们刚刚讲过就是R&N它是一个间接性的一个S、S、M对吧然后R&N它可以进行一个循环表示那么S、S、M呢你也可以进行一个循环表示其实就是这样的一个表示形式其实就是一个R&N对吧不过它里面的参数跟它的一个举证是不一样的然后就这个然后展开就是这个样子R&N它有一个什么好处呢就是它的一个推理速度是特别快的但是它也存在一个缺点就是它的一个训练速度特别慢那么有没有一种方式就是训练速度特别快其实是有的就是我们的一个卷机性的之前我们在CRE的时候已经接触过一个2V卷机对吧然后我们就是2V卷机对图像数据进行一个训练而在S、S、M当中我们也有一种卷机形式其实就是一个1V卷机我们都知道卷机其实就是我们的一个输入数据和卷机和进行一个调程所以我们要做的就是卷机和一个处理化这里我们处理化就使用这么一个公式就是K8等于CB把CAB把CAB把一直到CAB把K次方然后B把比如说我们的一个数据它有一个词那我们就K8等于CAB把如果两个词的话就是K8等于CAB把CAB把CAB把B把然后3个词就是K8等于CAB把CAB把CAB把B把然后一直CAB把的平方B把然后接下来我们就用这个数据和这个K8进行一个点程我们来看一下这里我们的一个句子假设就3个词吧然后我们的一个数据化的一个卷机和就是这个样子首先我们先对第一个词进行一个卷机操作但是它前面是没有词的所以我们要对它进行一个拍顶然后接下来就是对应元素相成然后相加都是一个外领对吧然后我们的一个卷机和网友去移动一个单位然后产生一个外移然后再移动一个产生一个外耳这样我们就对这个句子进行一个卷机操作接下来我们来看一下就是为什么卷机它可以进行一个变形的一个训练我们这里拿外耳来举例外耳呢它等于C1、C2然后H2呢它就等于A8、H1加B8、X2然后H1呢它就是A8、H0加B8、X1然后H0呢它就是A8、B8、X0加上B8、X1然后我们把这个A8给它沉进去接著我们把这个C8给它沉进去然后呢外3它就是这个样子然后我们外3换一种形式其实它是可以进行一个举证的一个形式我们都知道举证是可以变形结算的对吧所以我们的一个SSM它可以进行一个变形的一个训练这样我们就得到一个最有的训练方式就是我们训练是用卷机形式然后推理到我们是用胸环形式但是还有一个问题我们有解决就是这个这个方程我们都知道A举证它是代表之前所有隐藏时刻的一个浓缩所以我们A举证的一个出现化直接关酷了我们一个模型的一个好坏我们就使用HPOP来对A举证进行一个出现化然后大家这里就了解一下就OK具体为什么我们这里就不展开说了因为确实是比较难理解HPOP举证它的一个计算公式就是这样其实如果你们感兴趣的话自己去推下它其实就是一个下三交去证这样的话我们S4模型的一个定义就得到其实就是一个离散化的一个SSM然后使用一个变形的训练然后串形的一个推理再加上一个A举证的一个出现化如果我们要使用SS4模型的话那么我们首先需要把SSM给它离散化离散化完之后呢我们使用HPOP举证就是这个A举证进行一个出现化然后接下来我们使用并行的一个表示方式来进行训练跟我们先参数训练完之后我再使用一个串形的一个方式来进行一个推理这就是S4模型当然S4模型它也有一个缺陷就是因为它是一个现形的时间模型对吧所以我们在推理阶段我们的ABCA举证它不会因为输入不同而改变这是什么意思呢就比如说我们在训练阶段ABCA举证它是可以使用新学习的对吧但是在我们训练完之后在推理阶段我们ABCA举证就定下了不会因为我们的一个输入改变而发生改变这要就产生一个什么问题因为我们训练的时候是使用的一个变形选基所以它只会在乎我们聚责的整体而不会在乎聚责内部但是我们在推理的时候我们是一个单磁一个单磁的输进去我们希望这个模型它能够就是选择性的在乎每一个单磁之间的关系但是因为我们的ABCA举证它固定了所以它不会有选择性的选择每个单磁如果我们想让这个模型有选择性的话那么我们只能就是使用形形环表式来进行一个训练但是它的一个效率非常低所以我们就需要找一个不实用卷接著一个病性的训练报示其实这就是mama模型我们来看一下mama的三个创新点其实我们刚刚讲s的一个缺点有选择处理性系用点感知算法以及更简单的那个ssm加构我们现在看一下有选择处理性系这里它使用了一个门控机制门控机制我们在rstm那里了解我而我的aB举证不是定一下动不了的吗那我就对一个原始的一个数据对它进行一个处理我们知道使用了门控机制之后它会选择性的一望一些性系其实选择性的一望一些性系是不是就间接的实现了对性系的一个选择处理这是它的一个做法第二点是一个病性算明算我们来看一下首先我们有四个输入的一个项料然后分别去把它进行用一个B8的一个相成对吧然后接下来我们就要做的是一个类似于前效传播的一个操作就聊聊进行一个组合然后计算就比如说x0和x1进行一个组合就是h0加bx1对吧然后x2和x3进行一个组合就是bx2加bx3然后这里它两是不是还能组合然后我们就成一个a8然后再进行一个组合然后就h2加bx3然后进行到这里我们发现哦没有能组合的了那我们就进行一个回速就是来看一下哪些性系是缺失的比如说这里h0它是缺失的对吧那我就来计算一下h0然后h0计算完之后这个h1是不是也能计算出来了OK那我就进行一下h1的一个计算然后这里是不是缺一个h2那我们就来进行一下h2的一个计算对吧然后h2计算完了哦这里就可以继续往下进行了就进行一个h3的一个计算这就是一个并行扫描算法它主要分成两部分第一个是一个前效的然后再一个回速这里大家如果感兴趣的话就可以去缩一下其实它是一个硬件的一个算法然后它现在一到了我们这里面更简单的ssm架构的其实就是在ssm前面架一个前卫生经层就和车的formwork也这里我们没什么可说的OK其实mabar比较简单对吧因为我们之前把ssm模型给较了然后s4模型给较它其实就是在ssm形容上进行一个创新最后我们来说一下mabarmabar这个模型呢它的创新点是肯定有的但是它就选错了一个对手以及跟我刚才前面说的一个生物风食对吧这里就是大家进行了我的讲解视频之后就推荐大家去看一下论文可能会有更好的一个理解因为这里只是我个人理解如果哪里有错的话欢迎大家指出OK我们第一期视频了就结束了我们下期再见拜拜
